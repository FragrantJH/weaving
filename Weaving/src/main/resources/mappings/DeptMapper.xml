<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DeptDAO">

	<!-- 부서 등록 -->
	<insert id="insertDept" parameterType="dept">
	insert into department(dept_id ,dept_name ,upper_dept_id)
	values((SELECT NVL(MAX(DEPT_ID), 0) + 1 FROM DEPARTMENT )
		,#{deptName}
		<if test="upperDeptId != null">
		,#{upperDeptId}
		</if>
	)
	
	</insert>
	<!-- 부서 리스트 조회 -->
	<select id="getDeptList" resultType="dept" parameterType="dept">
		SELECT LPAD('-', 6*(LEVEL-1)) || dept_name dept_name, dept_id, UPPER_DEPT_ID
		FROM department
		START WITH dept_name='회사'
		CONNECT BY PRIOR dept_id=UPPER_DEPT_ID
	</select>
	
	<!-- 부서 조회 -->
    <select id ="getDept" resultType="dept" parameterType="dept">
        select dept_id, dept_name, upper_dept_id 
        from department 
        where dept_id = #{deptId}
    </select>
	
	<!-- 수정 -->
	<update id="updateDept" parameterType="dept">
		update department set
		dept_id = #{deptId}
		,dept_name = #{dpetName}
		,upper_dept_id = #{upperDeptId}
		where dept_id = #{deptId}
	</update>
</mapper>