<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="EmpDAO">
	<insert id="insertEmp" parameterType="emp">
		INSERT INTO EMPLOYEES(
								EMP_NO
								,EMP_NAME
								,PASSWORD
								<if test="position != null">
								,POSITION
								</if><if test="joindate1 != null">
								,JOINDATE
								</if>
								,EMAIL
								<if test="phone != null">
								,PHONE
								</if><if test="address != null">
								,ADDRESS
								</if><if test="deptId != null">
								,DEPT_ID
								</if><if test="deletedYn != null">
								,DELETED_YN
								</if><if test="deletedDate != null">
								,DELETED_DATE
								</if><if test="positionTitle != null">
								,POSITION_TITLE
								</if>
								)
		VALUES ( (SELECT NVL(MAX(EMP_NO), 0) + 1 FROM EMPLOYEES )
				,#{empName}
				,#{password}
				<if test="position != null">
				,#{position}
				</if><if test="joindate1 != null">
				,#{joindate1}
				</if>
				,#{email}
				<if test="phone != null">
				,#{phone}
				</if><if test="address != null">
				,#{address}
				</if><if test="deptId != null">
				,#{deptId}
				</if><if test="deletedYn != null">
				,#{deletedYn}
				</if><if test="deletedDate != null">
				,#{deletedDate}
				</if><if test="positionTitle != null">
				,#{positionTitle}
				</if>
				)
	</insert>
	<!-- 로그인 -->
	<select id ="getEmp" resultType="emp" parameterType="emp">
        select * from employees where emp_no =#{empNo} and password=#{password}
    </select>
    
    <!-- 개인조회 -->
    <select id ="getEmpl" resultType="emp" parameterType="emp">
        select * 
        from employees 
        where emp_no =#{empNo}
    </select>
    
    <!-- 사원 전체 조회 -->
    <select id="getEmpList" resultType="emp" parameterType="emp">
		select e.emp_no, e.emp_name, e.position_title, d.dept_name
		from employees e
		join department d
		on e.dept_id = d.dept_id
		order by e.emp_no desc
	</select>
	
	<!-- 수정 -->
	<update id="updateEmp" parameterType="emp">
		update employees set
		emp_name = #{password},
		password = #{name},
		position = #{role},
		email = #{role},
		phone = #{role},
		address = #{role},
		dept_id = #{role},
		position_title = #{role}
		where id = #{id}
	</update>
	
	<!-- 삭제 -->
	<delete id="deleteEmp" parameterType="emp">
		DELETE FROM EMPLOYEES
		WHERE EMP_NO = #{empNo}
	</delete>
</mapper>